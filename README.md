# Esbuild Lazy Analyzer

An esbuild visualizer that analyzes lazy-loading of chunks

[![GitHub](https://img.shields.io/badge/GitHub-Repo-blue?logo=github)](https://github.com/alexanderdombroski/esbuild-lazy-analyzer) [![Version](https://badge.fury.io/gh/alexanderdombroski%2Fesbuild-lazy-analyzer.svg)](https://badge.fury.io/gh/alexanderdombroski%2Fesbuild-lazy-analyzer)

## Installing

```zsh
npm i -D esbuild-lazy-analyzer
```

## Overview

Many bundlers allow you to use "splitting" to separate bundled code. This cli shows you how well you [split using esbuild](https://esbuild.github.io/api/#splitting).

## Usage

```zsh
npx esbuild-lazy-analyzer --metafile <meta.json> --outmeta <processed.json> --outreport <processed.html>
```

`--metafile` is required and at least one of the other `--out` options are also required.

### Outmeta

A json file to write with the following structure

```typescript
type BundleStats = {
  numberOfChunks: number;
  preBundleSize: number;
  bundleSize: number;
  compressionPercentage: number;
  minChunk: {
    name: string;
    size: number;
  };
  maxChunk: {
    name: string;
    size: number;
  };
  averageChunkSize: number;
  fileLeafs: string[];
  chunkLeafs: string[];
  entryStats: {
    [entryPoint: string]: EntryStats;
  };
};

type EntryStats = {
  type: 'inputs' | 'outputs';
  eagerImports: string[];
  lazyImports: string[];
  longestDependencyChain: string[];
  eagerImportSize: number;
};
```

### Outreport

Creates graphs of some of the above stats, and a map of files pre and post bundle.

Example import graph generated by the esbuild-lazy-analyzer cli

![import graph](https://raw.githubusercontent.com/alexanderdombroski/esbuild-lazy-analyzer/refs/heads/main/docs/images/import-graph.png)

## Release Notes

Check out the [changelog](https://github.com/alexanderdombroski/esbuild-lazy-analyzer/blob/main/CHANGELOG.md)

## License Information

Includes an [MIT license](https://github.com/alexanderdombroski/esbuild-lazy-analyzer?tab=MIT-1-ov-file#readme)

This project was inspired by [esbuild-visualizer](https://github.com/btd/esbuild-visualizer)
